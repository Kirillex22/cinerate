<div class="container">
  <div class="playlist-header">
    <h1>{{ playlistName }}</h1>
    <div class="action-buttons" *ngIf="showButtonDialog">
      <button *ngIf="!editMode" (click)="editPlaylist()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç</button>
      <button *ngIf="!editMode && isCreator" (click)="deletePlaylist()">–£–¥–∞–ª–∏—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç</button>
      <button *ngIf="!editMode && isCreator" (click)="manageAccess()">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ—Å—Ç—É–ø—ã</button>
      <button *ngIf="editMode" (click)="finishEdit()">–ó–∞–∫–æ–Ω—á–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
    </div>
  </div>

  <div class="playlist-header">
    <h2>{{ playlistDescription }}</h2>
  </div>

  <div *ngIf="isError" class="error-fullpage">
    –≠—Ç–æ –ø–æ–∫–∞ –ø—É—Å—Ç–æ–π –ø–ª–µ–π–ª–∏—Å—Ç ü§£
  </div>
  
  <div class="films-grid">
    <div class="film-card"
         *ngFor="let film of films; trackBy: trackByFilmId"
         (click)="!editMode && navigateToFilm(film.preview.filmid)"
         (mouseenter)="showFilmInfo(film)"
         (mouseleave)="hideFilmInfo()">
      <img [src]="film.preview.poster_link" [alt]="film.preview.name" class="film-poster">
      <button *ngIf="editMode && film.item.creatorid === currentUserId" class="remove-btn" 
      (click)="$event.stopPropagation(); removeFilm(film)">‚úñ</button>
      <img *ngIf="editMode && film.item.creatorid !== currentUserId && filmCreatorsMap[film.item.creatorid]" 
      class="creator-avatar" [src]="filmCreatorsMap[film.item.creatorid]!.avatar"
       [alt]="filmCreatorsMap[film.item.creatorid]!.username" [title]="filmCreatorsMap[film.item.creatorid]!.username" 
       (click)="$event.stopPropagation()">

       <img *ngIf="editMode && film.item.creatorid !== currentUserId && filmCreatorsMap[film.item.creatorid] && currentUserId == playlistCreatorId" 
        class="creator-avatar-admin" [src]="filmCreatorsMap[film.item.creatorid]!.avatar"
        [alt]="filmCreatorsMap[film.item.creatorid]!.username" [title]="filmCreatorsMap[film.item.creatorid]!.username" 
        (click)="$event.stopPropagation(); removeFilm(film)">

      <div class="film-info" *ngIf="hoveredFilm === film">
        <h3>{{ film.preview.name }}</h3>
        <p>–ì–æ–¥: {{ film.preview.release_year }}</p>
        <p>–°—Ç—Ä–∞–Ω–∞: {{ film.preview.countries.join(', ') }}</p>

        <ng-container *ngIf="film.preview.time_minutes !== null">
          <p>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {{ film.preview.time_minutes }} –º–∏–Ω.</p>
          <p class="type-label">–§–∏–ª—å–º</p>
        </ng-container>

        <ng-container *ngIf="film.preview.time_minutes === null">
          <p>–°–µ–∑–æ–Ω: {{ film.preview.season }}</p>
          <p class="type-label">–°–µ—Ä–∏–∞–ª</p>
        </ng-container>
      </div>
    </div>
  </div>

  <app-playlist-access-dialog
   *ngIf="showAccessDialog" 
   [playlistId]="playlistId" 
   (close)="showAccessDialog = false"
   (nameChange)="onPlaylistNameChange($event)"
   (descriptionChange)="onPlaylistDescriptionChange($event)">
  </app-playlist-access-dialog>
</div>

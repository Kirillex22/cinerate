<h1>–ü–æ–∏—Å–∫</h1>
<div class="search-container">
  <div class="search-layout">
    <div class="search-bar">
      <div class="range">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞:</label>
        <input [(ngModel)]="searchParams.name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞" />
      </div>
      <div *ngIf="!isExternal" class="range">
        <label>–ß–µ–ª–æ–≤–µ–∫:</label>
        <input [(ngModel)]="searchParams.person" placeholder="–ß–µ–ª–æ–≤–µ–∫" />
      </div>

      <!-- –ñ–∞–Ω—Ä—ã -->
      <div class="genres">
        <label>–ñ–∞–Ω—Ä:</label>
        <input [(ngModel)]="genreInput" list="genres-list" placeholder="–ñ–∞–Ω—Ä" (keyup.enter)="addGenre()" />
        <datalist id="genres-list">
          <option *ngFor="let g of genresList" [value]="g"></option>
        </datalist>
        <button (click)="addGenre()">+</button>
        <span class="genre-chip" *ngFor="let genre of searchParams.genres">
          {{ genre }} <button (click)="removeGenre(genre)">x</button>
        </span>
      </div>

      <!-- –ì–æ–¥ -->
      <div class="range">
        <label>–ì–æ–¥:</label>
        <input type="number" [(ngModel)]="searchParams.year.lower" placeholder="–æ—Ç" min="1900" max="2100" />
        <input type="number" [(ngModel)]="searchParams.year.upper" placeholder="–¥–æ" min="1900" max="2100" />
      </div>

      <!-- –†–µ–π—Ç–∏–Ω–≥ -->
      <div *ngIf="!isExternal" class="range">
        <label>KP —Ä–µ–π—Ç–∏–Ω–≥:</label>
        <input type="number" [(ngModel)]="searchParams.kp_rating.lower" placeholder="–æ—Ç" min="0" max="10" />
        <input type="number" [(ngModel)]="searchParams.kp_rating.upper" placeholder="–¥–æ" min="0" max="10" />
      </div>

      <!-- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å -->
      <div *class="range">
        <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω):</label>
        <input type="number" [(ngModel)]="searchParams.length.lower" placeholder="–æ—Ç" min="0" />
        <input type="number" [(ngModel)]="searchParams.length.upper" placeholder="–¥–æ" min="0" />
      </div>

      <!-- –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ -->
      <div class="range">
        <label>–í–æ–∑. —Ä–µ–π—Ç–∏–Ω–≥:</label>
        <input type="number" [(ngModel)]="searchParams.age_rating.lower" placeholder="–æ—Ç" min="0" max="18" />
        <input type="number" [(ngModel)]="searchParams.age_rating.upper" placeholder="–¥–æ" min="0" max="18" />
      </div>

      <!-- –°–µ—Ä–∏–∞–ª/—Ñ–∏–ª—å–º -->
      <select [(ngModel)]="searchParams.is_series">
        <option [ngValue]="undefined">–°–µ—Ä–∏–∞–ª –∏–ª–∏ —Ñ–∏–ª—å–º</option>
        <option [ngValue]="true">–°–µ—Ä–∏–∞–ª</option>
        <option [ngValue]="false">–§–∏–ª—å–º</option>
      </select>

      <!-- –í–Ω–µ—à–Ω–∏–π/–ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ -->
      <label>
        <input type="checkbox" [(ngModel)]="isExternal" /> –í–Ω–µ—à–Ω–∏–π –ø–æ–∏—Å–∫
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="isFireShow" /> –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ
      </label>

      <button (click)="search()">–ù–∞–π—Ç–∏</button>
    </div>

    <div *ngIf="dialogVisible" class="custom-dialog-backdrop">
      <div class="custom-dialog">
        <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–∑–æ–Ω</h2>
        <div class="season-buttons">
          <button *ngFor="let season of dialogSeasons" (click)="onSelectSeason(season)">
            {{ season }}
          </button>
        </div>
        <button class="add-all-btn" (click)="onAddAllSeasons()">–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Å–µ–∑–æ–Ω—ã</button>
        <button class="close-btn" (click)="onDialogClose()">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>

    <div class="films-grid" *ngIf="!errorMsg && films.length > 0">
      <div class="film-card"
           [class.already-added]="film.already_added && isFireShow"
           *ngFor="let film of films; trackBy: trackByFilmId"
           (click)="onFilmPosterClick(film)"
           (mouseenter)="showFilmInfo(film)"
           (mouseleave)="hideFilmInfo()">
        <img [src]="film.poster_link" [alt]="film.name" class="film-poster" />
        <div class="film-info" *ngIf="hoveredFilm === film">
          <h3>{{ film.name }}</h3>
          <p *ngIf="film.alternative_name" class="alternative-name">{{ film.alternative_name }}</p>
          <p>–ì–æ–¥: {{ film.release_year }}</p>
          <p>–°—Ç—Ä–∞–Ω–∞: {{ film.countries?.join(', ') }}</p>
          <ng-container *ngIf="film.time_minutes !== null">
            <p>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {{ film.time_minutes }} –º–∏–Ω.</p>
            <p class="type-label">–§–∏–ª—å–º</p>
          </ng-container>
          <ng-container *ngIf="film.time_minutes === null">
            <p>–°–µ–∑–æ–Ω: {{ film.season }}</p>
            <p class="type-label">–°–µ—Ä–∏–∞–ª</p>
          </ng-container>
          <p>–ñ–∞–Ω—Ä—ã: {{ film.genres?.join(', ') }}</p>
          <p>–†–µ–∂–∏—Å—Å—ë—Ä: {{ film.director }}</p>
          <p>–í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥: {{ film.age_rating }}+</p>
          <p>{{ film.is_watched ? '–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ' : '–ù–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ' }}</p>
        </div>
      </div>
    </div>
    <div *ngIf="!errorMsg && films.length === 0" class="no-results">–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ü•µüôà</div>
    <div *ngIf="errorMsg" class="error-msg">{{ errorMsg }}‚ò†</div>
  </div>
</div>

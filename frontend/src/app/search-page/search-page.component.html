<h1>–ü–æ–∏—Å–∫</h1>
<div class="search-container">
  <div class="search-layout">
    <div class="search-bar">
      <div class="range">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞:</label>
        <input [(ngModel)]="searchParams.name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞" />
      </div>
      <div *ngIf="!isExternal" class="range">
        <label>–ß–µ–ª–æ–≤–µ–∫:</label>
        <input [(ngModel)]="searchParams.person" placeholder="–ß–µ–ª–æ–≤–µ–∫" />
      </div>

      <!-- –ñ–∞–Ω—Ä—ã -->
      <div class="genres">
        <label>–ñ–∞–Ω—Ä:</label>
        <input style="width: 160px" [(ngModel)]="genreInput" list="genres-list" placeholder="–ñ–∞–Ω—Ä" (keyup.enter)="addGenre()" />
        <datalist id="genres-list">
          <option *ngFor="let g of genresList" [value]="g"></option>
        </datalist>
        <button class="no-style" (click)="addGenre()"><img src="assets/add.svg" alt="–î–æ–±–∞–≤–∏—Ç—å –∂–∞–Ω—Ä"></button>
        <span class="genre-chip" *ngFor="let genre of searchParams.genres">
          {{ genre }} <button (click)="removeGenre(genre)" class="no-style"><img src="assets/delete.svg" style="height: 10px; margin-left: 5px; " alt="–£–¥–∞–ª–∏—Ç—å –∂–∞–Ω—Ä"></button>
        </span>
      </div>

      <div class="genres">
        <label>–°—Ç—Ä–∞–Ω–∞:</label>
        <input style="width: 160px" [(ngModel)]="countryInput" list="country-list" placeholder="–°—Ç—Ä–∞–Ω–∞" (keyup.enter)="addCountry()" />
        <datalist id="country-list">
          <option *ngFor="let c of countryList" [value]="c"></option>
        </datalist>
        <button class="no-style" (click)="addCountry()"><img src="assets/add.svg" alt="–î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ä–Ω—É"></button>
        <span class="genre-chip" *ngFor="let country of searchParams.countries">
          {{ country }} <button (click)="removeCountry(country)" class="no-style"><img src="assets/delete.svg" style="height: 10px; margin-left: 5px; " alt="–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–∞–Ω—É"></button>
        </span>
      </div>

      <!-- –ì–æ–¥ -->
      <div class="range">
        <label>–ì–æ–¥:</label>
        <input type="number" [(ngModel)]="searchParams.year.lower" placeholder="–æ—Ç" min="1900" max="2100" />
        <input type="number" [(ngModel)]="searchParams.year.upper" placeholder="–¥–æ" min="1900" max="2100" />
      </div>

      <!-- –†–µ–π—Ç–∏–Ω–≥ -->
      <div *ngIf="!isExternal" class="range">
        <label>KP —Ä–µ–π—Ç–∏–Ω–≥:</label>
        <input type="number" [(ngModel)]="searchParams.kp_rating.lower" placeholder="–æ—Ç" min="0" max="10" />
        <input type="number" [(ngModel)]="searchParams.kp_rating.upper" placeholder="–¥–æ" min="0" max="10" />
      </div>

      <!-- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å -->
      <div class="range" style="flex-wrap: nowrap;">
        <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω):</label>
        <input type="number" style="width: 55px;" [(ngModel)]="searchParams.length.lower" placeholder="–æ—Ç" min="0" />
        <input type="number" style="width: 55px;" [(ngModel)]="searchParams.length.upper" placeholder="–¥–æ" min="0" />
      </div>

      <!-- –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ -->
      <div class="range">
        <label>–í–æ–∑. —Ä–µ–π—Ç–∏–Ω–≥:</label>
        <input type="number" [(ngModel)]="searchParams.age_rating.lower" placeholder="–æ—Ç" min="0" max="18" />
        <input type="number" [(ngModel)]="searchParams.age_rating.upper" placeholder="–¥–æ" min="0" max="18" />
      </div>

      <!-- –°–µ—Ä–∏–∞–ª/—Ñ–∏–ª—å–º -->
      <select class="custom-select" [(ngModel)]="searchParams.is_series">
        <option [ngValue]="undefined">–°–µ—Ä–∏–∞–ª –∏–ª–∏ —Ñ–∏–ª—å–º</option>
        <option [ngValue]="true">–°–µ—Ä–∏–∞–ª</option>
        <option [ngValue]="false">–§–∏–ª—å–º</option>
      </select>

      <!-- –í–Ω–µ—à–Ω–∏–π/–ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ -->
      <label>
        <input type="checkbox" [(ngModel)]="isExternal" /> –í–Ω–µ—à–Ω–∏–π –ø–æ–∏—Å–∫
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="isFireShow" /> –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ
      </label>

      <button (click)="search()">–ù–∞–π—Ç–∏</button>
    </div>

    <div *ngIf="dialogVisible" class="custom-dialog-overlay">
      <div class="custom-dialog">
        <div class="dialog-header">
          <h2 class="dialog-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–∑–æ–Ω</h2>
          <button class="close-btn" (click)="onDialogClose()">
            <img src="assets/close.svg" alt="–ó–∞–∫—Ä—ã—Ç—å">
          </button>
        </div>
        <div class="season-buttons">
          <button *ngFor="let season of dialogSeasons" (click)="onSelectSeason(season)">
            {{ season }}
          </button>
        </div>
        <div class="buttom-actions">
          <button class="action-btn" (click)="onAddAllSeasons()">–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Å–µ–∑–æ–Ω—ã</button>
        </div>
      </div>
    </div>


    <div class="films-grid" *ngIf="!errorMsg && films.length > 0">
      <div class="film-card"
           [class.already-added]="film.already_added && isFireShow"
           *ngFor="let film of films; trackBy: trackByFilmId"
           (click)="onFilmPosterClick(film)"
           (mouseenter)="showFilmInfo(film)"
           (mouseleave)="hideFilmInfo()">
        <img [src]="film.poster_link" [alt]="film.name" class="film-poster" />
        <div class="film-info" *ngIf="hoveredFilm === film">
          <div class="film-name">
            {{ film.name }}
            <span style="font-weight: 400; color: #9d9d9d;">{{ film.release_year }}</span>
          </div>
          
          <p *ngIf="film.alternative_name" class="alternative-name">{{ film.alternative_name }}</p>
          
          <p>{{ film.countries.join(', ') }}</p>
          
          <ng-container *ngIf="film.time_minutes != null && film.time_minutes !== 0; else serialCard">
            <p>{{ film.time_minutes }} –º–∏–Ω</p>
            <p class="type-label">–§–∏–ª—å–º</p>
          </ng-container>
          
          <ng-template #serialCard>
            <p class="type-label">–°–µ—Ä–∏–∞–ª</p>
          </ng-template>
        </div>
      </div>
    </div>
    <div *ngIf="!errorMsg && films.length === 0" class="no-results">–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ü•µüôà</div>
    <div *ngIf="errorMsg" class="error-msg">{{ errorMsg }}‚ò†</div>
  </div>
</div>
